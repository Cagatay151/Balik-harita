<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>CanlÄ± BalÄ±k HaritasÄ±</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
  body, html { margin: 0; padding: 0; }
  #map { height: 100vh; width: 100%; }

  .legend {
    position: absolute;
    bottom: 20px;
    left: 20px;
    background: white;
    padding: 10px;
    font-size: 14px;
    border-radius: 6px;
    box-shadow: 0 0 5px rgba(0,0,0,0.3);
  }
  .legend span {
    display: inline-block;
    width: 12px;
    height: 12px;
    margin-right: 6px;
    border-radius: 50%;
  }
</style>
</head>

<body>

<div id="map"></div>

<div class="legend">
  <div><span style="background:red"></span> Balon BalÄ±ÄŸÄ±</div>
  <div><span style="background:orange"></span> Aslan BalÄ±ÄŸÄ±</div>
  <div><span style="background:purple"></span> Sokar BalÄ±ÄŸÄ±</div>
  <div><span style="background:blue"></span> DiÄŸer TÃ¼rler</div>
</div>

<script>
// ðŸ—ºï¸ Harita
var map = L.map('map').setView([36.3067, 30.1467], 14);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: 'Â© OpenStreetMap'
}).addTo(map);

// ðŸŽ¨ TÃ¼rlere gÃ¶re renk
function renk(tur) {
  if (tur === "Balon BalÄ±ÄŸÄ±") return "red";
  if (tur === "Aslan BalÄ±ÄŸÄ±") return "orange";
  if (tur === "Sokar BalÄ±ÄŸÄ±") return "purple";
  return "blue";
}

// ðŸŒŠ KÄ±yÄ±dan 10â€“50 metre deniz iÃ§ine otomatik kaydÄ±rma (daha doÄŸru)
function denizeKaydir(lat, lon) {
  var mesafe = 10 + Math.random() * 40; // metre
  var aci = 180; // doÄŸrudan denize (gÃ¼ney) yÃ¶nÃ¼, isterseniz Â±20Â° ekleyebilirsiniz
  var R = 6378137; // DÃ¼nya yarÄ±Ã§apÄ± metre cinsinden

  var dLat = (mesafe * Math.cos(aci * Math.PI / 180)) / R;
  var dLon = (mesafe * Math.sin(aci * Math.PI / 180)) / (R * Math.cos(lat * Math.PI / 180));

  return [lat + (dLat * 180 / Math.PI), lon + (dLon * 180 / Math.PI)];
}


// ðŸ”— GOOGLE SHEETS CSV LÄ°NKÄ°NÄ° BURAYA YAPIÅžTIR
var csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTNlPn-37eDEwJHvLmp2Ed-uEZ0J3YDkMavOHv-fSLQfXHhuMlkMntf2WSZKuwOeWwCGBrawKimHGbE/pub?gid=88890813&single=true&output=csv";

fetch(csvUrl)
  .then(r => r.text())
  .then(csv => {
    var rows = csv.split("\n").slice(1);

    rows.forEach(row => {
      var c = row.split(",");
      if (c.length < 5) return;

      var tur = c[0];
      var yer = c[2];
      var lat = parseFloat(c[3]);
      var lon = parseFloat(c[4]);

      if (isNaN(lat) || isNaN(lon)) return;

      var yeniKonum = denizeKaydir(lat, lon);

      L.circleMarker(yeniKonum, {
        radius: 6,
        color: renk(tur),
        fillColor: renk(tur),
        fillOpacity: 0.8
      })
      .bindPopup("<b>" + tur + "</b><br>" + yer)
      .addTo(map);
    });
  });
</script>

</body>
</html>


